<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estado del Deployment</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #22c55e;
        }
        .status-card.error {
            border-left-color: #ef4444;
        }
        .status-card.warning {
            border-left-color: #f59e0b;
        }
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .btn {
            background: linear-gradient(45deg, #22c55e, #16a34a);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
        }
        .btn.secondary {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
        }
        .btn.secondary:hover {
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        #results {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            font-family: 'Courier New', monospace;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #22c55e;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .emoji {
            font-size: 2em;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">üîç</span>Verificaci√≥n de Deployment</h1>
        
        <div class="status-card">
            <h3>üìç Informaci√≥n de URL</h3>
            <div class="info-grid">
                <div>
                    <strong>URL Actual:</strong><br>
                    <code id="current-url"></code>
                </div>
                <div>
                    <strong>Hostname:</strong><br>
                    <code id="hostname"></code>
                </div>
                <div>
                    <strong>Path:</strong><br>
                    <code id="pathname"></code>
                </div>
                <div>
                    <strong>Base Esperada:</strong><br>
                    <code>/Curso-Git-Agent/</code>
                </div>
            </div>
        </div>

        <div class="status-card">
            <h3>üß™ Pruebas de Recursos</h3>
            <button class="btn" onclick="runTests()">
                <span class="emoji">üöÄ</span> Ejecutar Pruebas
            </button>
            <button class="btn secondary" onclick="clearAllCache()">
                <span class="emoji">üßπ</span> Limpiar Cache
            </button>
            <button class="btn secondary" onclick="goToMainApp()">
                <span class="emoji">üè†</span> Ir a la App
            </button>
            <div id="results"></div>
        </div>

        <div class="status-card">
            <h3>üìä Estado del Sistema</h3>
            <div id="system-status">
                <div class="loading"></div> Verificando estado...
            </div>
        </div>
    </div>

    <script>
        // Mostrar informaci√≥n de URL
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('hostname').textContent = window.location.hostname;
        document.getElementById('pathname').textContent = window.location.pathname;

        // Verificar estado del sistema
        setTimeout(() => {
            const systemStatus = document.getElementById('system-status');
            const isGitHub = window.location.hostname === 'kevinarauz.github.io';
            const isCorrectPath = window.location.pathname.startsWith('/Curso-Git-Agent/');
            
            if (isGitHub && isCorrectPath) {
                systemStatus.innerHTML = '‚úÖ <strong>Sistema OK</strong> - Ejecut√°ndose en GitHub Pages con ruta correcta';
                systemStatus.parentElement.classList.remove('error', 'warning');
            } else if (isGitHub && !isCorrectPath) {
                systemStatus.innerHTML = '‚ö†Ô∏è <strong>Advertencia</strong> - En GitHub Pages pero ruta incorrecta';
                systemStatus.parentElement.classList.add('warning');
            } else {
                systemStatus.innerHTML = 'üîß <strong>Desarrollo</strong> - Ejecut√°ndose en entorno local';
                systemStatus.parentElement.classList.remove('error', 'warning');
            }
        }, 1000);

        async function runTests() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="loading"></div> Ejecutando pruebas...';
            
            const tests = [
                { name: 'Archivo Principal', url: './index.html', critical: true },
                { name: 'Manifest', url: './site.webmanifest', critical: false },
                { name: 'Vite Logo', url: './vite.svg', critical: false },
                { name: 'GitHub Pages Fix', url: './github-pages-fix.js', critical: true },
                { name: 'CSS Principal', url: './assets/index.css', critical: true },
                { name: 'JS Principal', url: './assets/index.js', critical: true },
                { name: 'Script Principal', url: './src/main.tsx', critical: true }
            ];
            
            const testResults = [];
            let passed = 0;
            let failed = 0;
            
            for (const test of tests) {
                try {
                    const response = await fetch(test.url);
                    if (response.ok) {
                        testResults.push(`‚úÖ ${test.name}: OK (${response.status})`);
                        passed++;
                    } else {
                        testResults.push(`‚ùå ${test.name}: Error ${response.status}${test.critical ? ' (CR√çTICO)' : ''}`);
                        failed++;
                    }
                } catch (error) {
                    testResults.push(`‚ùå ${test.name}: Error de red${test.critical ? ' (CR√çTICO)' : ''}`);
                    failed++;
                }
            }
            
            const summary = `
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>üìà Resumen de Pruebas</h4>
                    <div style="display: flex; gap: 20px;">
                        <div style="color: #22c55e;">‚úÖ Pasadas: ${passed}</div>
                        <div style="color: #ef4444;">‚ùå Falladas: ${failed}</div>
                        <div style="color: #f59e0b;">üìä Total: ${tests.length}</div>
                    </div>
                </div>
            `;
            
            results.innerHTML = summary + testResults.map(result => `<div style="padding: 5px;">${result}</div>`).join('');
            
            if (failed === 0) {
                results.innerHTML += '<div style="color: #22c55e; font-weight: bold; text-align: center; padding: 15px;">üéâ ¬°Todas las pruebas pasaron correctamente!</div>';
            } else {
                results.innerHTML += '<div style="color: #ef4444; font-weight: bold; text-align: center; padding: 15px;">‚ö†Ô∏è Algunas pruebas fallaron. Revisa la configuraci√≥n.</div>';
            }
        }
        
        function clearAllCache() {
            // Limpiar cache de service worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(registration => registration.unregister());
                });
            }
            
            // Limpiar cache de la API
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => caches.delete(name));
                });
            }
            
            // Limpiar storage
            localStorage.clear();
            sessionStorage.clear();
            
            // Recargar p√°gina
            window.location.reload(true);
        }
        
        function goToMainApp() {
            window.location.href = './index.html';
        }
        
        // Ejecutar pruebas autom√°ticamente despu√©s de 2 segundos
        setTimeout(runTests, 2000);
    </script>
</body>
</html>
